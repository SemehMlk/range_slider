import org.mapstruct.*;
import com.example.model.UserPreferenceDto; // Importez le DTO généré par OpenAPI

@Mapper(componentModel = "spring")
public interface UserPreferenceMapper {

    @Mapping(target = "configs", expression = "java(convertConfigsToString(dto.getConfigs()))")
    UserPreferenceEntity toEntity(UserPreferenceDto dto);

    @Mapping(target = "configs", expression = "java(convertStringToConfigs(entity.getConfigs()))")
    UserPreferenceDto toDto(UserPreferenceEntity entity);

    @Named("convertConfigsToString")
    default String convertConfigsToString(Object configs) {
        // Utilisez Jackson ou Gson pour convertir l'objet en JSON
        return new ObjectMapper().writeValueAsString(configs);
    }

    @Named("convertStringToConfigs")
    default Object convertStringToConfigs(String configs) {
        // Utilisez Jackson ou Gson pour convertir le JSON en objet
        return new ObjectMapper().readValue(configs, Object.class);
    }
}
