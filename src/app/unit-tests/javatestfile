import { Injectable } from '@angular/core';
import { AgGridFilterModel } from '../models/filter.model';

@Injectable({
  providedIn: 'root'
})
export class FilterService {
  private filters: Map<string, AgGridFilterModel> = new Map();

  setFilters(context: string, filters: AgGridFilterModel): void {
    this.filters.set(context, filters);
  }

  getFilters(context: string): AgGridFilterModel | null {
    return this.filters.get(context) || null;
  }

  resetFilters(context: string): void {
    this.filters.delete(context);
  }

  resetAllFilters(): void {
    this.filters.clear();
  }
}


dans la.liste
import { Router } from '@angular/router';
import { FilterService } from '../services/filter.service';
import { AgGridFilterModel } from '../models/filter.model';

constructor(private router: Router, private filterService: FilterService) {}

onNavigateToDetail(selectedItem: any) {
  const gridFilters: AgGridFilterModel = this.gridApi.getFilterModel();
  this.filterService.setFilters('list-page', gridFilters);
  this.router.navigate(['/detail', selectedItem.id]);
}

ngOnInit() {
  const savedFilters = this.filterService.getFilters('list-page');
  if (savedFilters) {
    this.gridApi.setFilterModel(savedFilters);
  }
}

import { Router, NavigationEnd } from '@angular/router';
import { FilterService } from '../services/filter.service';

constructor(private router: Router, private filterService: FilterService) {}

ngOnInit() {
  this.router.events.subscribe(event => {
    if (event instanceof NavigationEnd && !event.url.includes('/detail')) {
      this.filterService.resetFilters('list-page'); // Reset seulement pour la liste
    }
  });
}


export interface AgGridFilterModel {
  [key: string]: {
    filterType: string;
    type?: string;
    filter?: string | number | boolean;
    values?: string[];
  };
}



