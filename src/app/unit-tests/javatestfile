const criteriaBuilders = new Map<FlxApiSearchableField.FieldTypeEnum, (criteria: FilterCriteria) => FlxApiSearchCriteria | null>([
    [FlxApiSearchableField.FieldTypeEnum.ENUM, (criteria) =>
        isFilterValid(criteria) ? buildListTypeCriteria(criteria.field, criteria.value, criteria.operator !== FlxApiConditionOperator.NOT_IN) : null
    ],
    [FlxApiSearchableField.FieldTypeEnum.TEXT, (criteria) =>
        isFilterValid(criteria) ? buildTextTypeCriteria(criteria.field, criteria.value, criteria.operator) : null
    ],
    [FlxApiSearchableField.FieldTypeEnum.NUMBER, (criteria) =>
        isFilterValid(criteria) ? buildNumberTypeCriteria(criteria.field, criteria.value, criteria.operator) : null
    ],
    [FlxApiSearchableField.FieldTypeEnum.DATETIME, (criteria) =>
        isFilterValid(criteria) ? buildDateTimeTypeCriteria(criteria.field, criteria.value, criteria.operator) : null
    ]
]);

export function buildCriterias(criteriaList: FilterCriteria[]): FlxApiSearchCriteria[] {
    const backendCriterias: FlxApiSearchCriteria[] = [];

    for (const criteria of criteriaList) {
        const builder = criteriaBuilders.get(criteria.fieldType);
        if (builder) {
            const backendCriteria = builder(criteria);
            if (backendCriteria) {
                backendCriterias.push(backendCriteria);
            }
        }
    }

    return backendCriterias;
}
