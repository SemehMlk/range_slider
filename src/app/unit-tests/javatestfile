@Override
public void processPayload(ReceivedInboundMessage message) {
    final long messageId = Long.parseLong(String.valueOf(message.getId()));

    inboundMessageRepository.findById(messageId)
        .ifPresentOrElse(inboundMessage -> {
            log.trace("Inbound message: {}", inboundMessage);

            ParsedCanonicalBean parsedCanonicalBean = messagesService.parseMessage(
                MessageToParseRequest.builder()
                    .content(inboundMessage.getContent())
                    .build()
            );

            log.info("Parsed message: {}", parsedCanonicalBean);

            CanonicalMessage canonicalMessage = CanonicalMessage.builder()
                .id(inboundMessage.getId())
                .messageType(parsedCanonicalBean.getMessageType())
                .mur(parsedCanonicalBean.getMur())
                .uetr(parsedCanonicalBean.getUetr())
                .trn(parsedCanonicalBean.getTrn())
                .amount(parsedCanonicalBean.getAmount())
                .currency(parsedCanonicalBean.getCurrency())
                .senderBic(parsedCanonicalBean.getSenderBic())
                .receiverBic(parsedCanonicalBean.getReceiverBic())
                .creditorAccount(parsedCanonicalBean.getCreditorAccount())
                .instructionForCreditorAgent(parsedCanonicalBean.getCreditorAgentInstruction())
                .instructionForNextAgent(parsedCanonicalBean.getNextAgentInstruction())
                .remittanceInformation(parsedCanonicalBean.getUnstructuredRemittanceInformation())
                .status(MessageStatus.VALIDATED)
                .inboundMessage(inboundMessage)
                .build();

            inboundMessage.setCanonicalMessage(canonicalMessage);
            canonicalMessageRepository.save(canonicalMessage);
        }, () -> log.error("Could not find canonical message by ID <{}>.", messageId));
}
