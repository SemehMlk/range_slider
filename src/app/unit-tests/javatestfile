import org.json.JSONObject;
import org.springframework.http.ResponseEntity;
import org.springframework.http.MediaType;
import org.springframework.web.client.RestClient;

public class TokenService {

    public static void main(String[] args) {
        RestClient restClient = RestClientFactory.createInsecureRestClient();

        ResponseEntity<String> response = restClient.post()
            .uri("https://api.example.com/token")
            .header("Authorization", "Basic xxxxxx")
            .contentType(MediaType.APPLICATION_FORM_URLENCODED)
            .body("grant_type=client_credentials")
            .retrieve()
            .toEntity(String.class);

        if (response.getStatusCode().is2xxSuccessful()) {
            // Transformer la r√©ponse en objet JSON
            JSONObject jsonObject = new JSONObject(response.getBody());

            // Extraire des valeurs du JSON
            String accessToken = jsonObject.getString("access_token");
            int expiresIn = jsonObject.getInt("expires_in");

            System.out.println("Token : " + accessToken);
            System.out.println("Expire dans : " + expiresIn + " secondes");
        } else {
            System.out.println("Erreur HTTP : " + response.getStatusCodeValue());
        }
    }
}
